<?php
/**
 * Description of PHPClass
 *
 * @author garmaser
 */
class gms_TablaInput {
    public $nivelPrimariaSecundaria='';
   
    function tabla($numColumnas,$funciones,$tiposDeCelda,$DatosEstudiantes,$IdTrimestre){
        //echo '<table class="tabla" border="0" align="center" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF" >';
        //for ($fila=1; $fila<=$numFilas; $fila++){        
        $fila=0;
       while($row=$DatosEstudiantes->fetch()){
            //extrae los valores del parcial actual
            $ValoresSaberHacer=array($row['ud'.$IdTrimestre.'01'], $row['ud'.$IdTrimestre.'02'], $row['ud'.$IdTrimestre.'03'], $row['ud'.$IdTrimestre.'04'], $row['ud'.$IdTrimestre.'05'], $row['ud'.$IdTrimestre.'06'], $row['ud'.$IdTrimestre.'07'], $row['ud'.$IdTrimestre.'08'], $row['ae'.$IdTrimestre.'01'], $row['ae'.$IdTrimestre.'02'], $row['ae'.$IdTrimestre.'03'], $row['ae'.$IdTrimestre.'04'], $row['ae'.$IdTrimestre.'05'], $row['ae'.$IdTrimestre.'06'], $row['ae'.$IdTrimestre.'07'], $row['ae'.$IdTrimestre.'08'], $row['ae'.$IdTrimestre.'09'], $row['ae'.$IdTrimestre.'10']);

            //verifica si el trimestre es 1º o 2º  y su parcial sea el 2º (los valores 2-4 pertenecen a este parcial)
            if ($IdTrimestre==2 ||$IdTrimestre==4 || $IdTrimestre==6){
                // extrae los valores de DPS
                $valoresDPS=array($row['dps'.$IdTrimestre.'01'], $row['dps'.$IdTrimestre.'02'],$row['dps'.$IdTrimestre.'03']);
                //extrae los valores del 1ºparcial del trimestre actual (para calculo de promedios de 2ºparcial)
                $IdTrimestreParcial1=$IdTrimestre-1;
                $ValoresSaberHacerParcial1=array($row['ud'.$IdTrimestreParcial1.'01'], $row['ud'.$IdTrimestreParcial1.'02'], $row['ud'.$IdTrimestreParcial1.'03'], $row['ud'.$IdTrimestreParcial1.'04'], $row['ud'.$IdTrimestreParcial1.'05'], $row['ud'.$IdTrimestreParcial1.'06'], $row['ud'.$IdTrimestreParcial1.'07'], $row['ud'.$IdTrimestreParcial1.'08'], $row['ae'.$IdTrimestreParcial1.'01'], $row['ae'.$IdTrimestreParcial1.'02'], $row['ae'.$IdTrimestreParcial1.'03'], $row['ae'.$IdTrimestreParcial1.'04'], $row['ae'.$IdTrimestreParcial1.'05'], $row['ae'.$IdTrimestreParcial1.'06'], $row['ae'.$IdTrimestreParcial1.'07'], $row['ae'.$IdTrimestreParcial1.'08'], $row['ae'.$IdTrimestreParcial1.'09'], $row['ae'.$IdTrimestreParcial1.'10']);
            }
            if ($IdTrimestre==6){
                // extrae los valores de DPS
                $valoresDPS=array($row['dps'.$IdTrimestre.'01'], $row['dps'.$IdTrimestre.'02'],$row['dps'.$IdTrimestre.'03']);
                
                //extrae los valores del 1º trimestre
                $IdTrimestreParcial1=1;
                $ValoresTrimestre1Parcial1=array($row['ud'.$IdTrimestreParcial1.'01'], $row['ud'.$IdTrimestreParcial1.'02'], $row['ud'.$IdTrimestreParcial1.'03'], $row['ud'.$IdTrimestreParcial1.'04'], $row['ud'.$IdTrimestreParcial1.'05'], $row['ud'.$IdTrimestreParcial1.'06'], $row['ud'.$IdTrimestreParcial1.'07'], $row['ud'.$IdTrimestreParcial1.'08'], $row['ae'.$IdTrimestreParcial1.'01'], $row['ae'.$IdTrimestreParcial1.'02'], $row['ae'.$IdTrimestreParcial1.'03'], $row['ae'.$IdTrimestreParcial1.'04'], $row['ae'.$IdTrimestreParcial1.'05'], $row['ae'.$IdTrimestreParcial1.'06'], $row['ae'.$IdTrimestreParcial1.'07'], $row['ae'.$IdTrimestreParcial1.'08'], $row['ae'.$IdTrimestreParcial1.'09'], $row['ae'.$IdTrimestreParcial1.'10']);
                $IdTrimestreParcial1=2;
                $ValoresTrimestre1Parcial2=array($row['ud'.$IdTrimestreParcial1.'01'], $row['ud'.$IdTrimestreParcial1.'02'], $row['ud'.$IdTrimestreParcial1.'03'], $row['ud'.$IdTrimestreParcial1.'04'], $row['ud'.$IdTrimestreParcial1.'05'], $row['ud'.$IdTrimestreParcial1.'06'], $row['ud'.$IdTrimestreParcial1.'07'], $row['ud'.$IdTrimestreParcial1.'08'], $row['ae'.$IdTrimestreParcial1.'01'], $row['ae'.$IdTrimestreParcial1.'02'], $row['ae'.$IdTrimestreParcial1.'03'], $row['ae'.$IdTrimestreParcial1.'04'], $row['ae'.$IdTrimestreParcial1.'05'], $row['ae'.$IdTrimestreParcial1.'06'], $row['ae'.$IdTrimestreParcial1.'07'], $row['ae'.$IdTrimestreParcial1.'08'], $row['ae'.$IdTrimestreParcial1.'09'], $row['ae'.$IdTrimestreParcial1.'10']);
                $ValoresTrimestre1Parcial2DPS=array($row['dps'.$IdTrimestreParcial1.'01'], $row['dps'.$IdTrimestreParcial1.'02'], $row['dps'.$IdTrimestreParcial1.'03']);
                $Notaparcial1=$this->promedio($ValoresTrimestre1Parcial1);
                $Notaparcial2=$this->promedio($ValoresTrimestre1Parcial2);
                $NotaDPS=$this->promedio($ValoresTrimestre1Parcial2DPS);
                if(!is_numeric($Notaparcial1))  $Notaparcial1=0;
                if(!is_numeric($Notaparcial2))  $Notaparcial2=0;
                $Notaparcial1parcial2=$this->promedio(array($Notaparcial1, $Notaparcial2));
                if(!is_numeric($Notaparcial1parcial2))  $Notaparcial1parcial2=0;
                if(!is_numeric($NotaDPS))  $NotaDPS=0;
                if ($this->nivelPrimariaSecundaria=='primaria')     $NotaDPS=0;
                $NotaTrimestre1=$Notaparcial1parcial2 + $NotaDPS;
                
                //extrae los valores del 2º trimestre
                $IdTrimestreParcial1=3;
                $ValoresTrimestre1Parcial1=array($row['ud'.$IdTrimestreParcial1.'01'], $row['ud'.$IdTrimestreParcial1.'02'], $row['ud'.$IdTrimestreParcial1.'03'], $row['ud'.$IdTrimestreParcial1.'04'], $row['ud'.$IdTrimestreParcial1.'05'], $row['ud'.$IdTrimestreParcial1.'06'], $row['ud'.$IdTrimestreParcial1.'07'], $row['ud'.$IdTrimestreParcial1.'08'], $row['ae'.$IdTrimestreParcial1.'01'], $row['ae'.$IdTrimestreParcial1.'02'], $row['ae'.$IdTrimestreParcial1.'03'], $row['ae'.$IdTrimestreParcial1.'04'], $row['ae'.$IdTrimestreParcial1.'05'], $row['ae'.$IdTrimestreParcial1.'06'], $row['ae'.$IdTrimestreParcial1.'07'], $row['ae'.$IdTrimestreParcial1.'08'], $row['ae'.$IdTrimestreParcial1.'09'], $row['ae'.$IdTrimestreParcial1.'10']);
                $IdTrimestreParcial1=4;
                $ValoresTrimestre1Parcial2=array($row['ud'.$IdTrimestreParcial1.'01'], $row['ud'.$IdTrimestreParcial1.'02'], $row['ud'.$IdTrimestreParcial1.'03'], $row['ud'.$IdTrimestreParcial1.'04'], $row['ud'.$IdTrimestreParcial1.'05'], $row['ud'.$IdTrimestreParcial1.'06'], $row['ud'.$IdTrimestreParcial1.'07'], $row['ud'.$IdTrimestreParcial1.'08'], $row['ae'.$IdTrimestreParcial1.'01'], $row['ae'.$IdTrimestreParcial1.'02'], $row['ae'.$IdTrimestreParcial1.'03'], $row['ae'.$IdTrimestreParcial1.'04'], $row['ae'.$IdTrimestreParcial1.'05'], $row['ae'.$IdTrimestreParcial1.'06'], $row['ae'.$IdTrimestreParcial1.'07'], $row['ae'.$IdTrimestreParcial1.'08'], $row['ae'.$IdTrimestreParcial1.'09'], $row['ae'.$IdTrimestreParcial1.'10']);
                $ValoresTrimestre1Parcial2DPS=array($row['dps'.$IdTrimestreParcial1.'01'], $row['dps'.$IdTrimestreParcial1.'02'], $row['dps'.$IdTrimestreParcial1.'03']);
                $Notaparcial1=$this->promedio($ValoresTrimestre1Parcial1);
                $Notaparcial2=$this->promedio($ValoresTrimestre1Parcial2);
                $NotaDPS=$this->promedio($ValoresTrimestre1Parcial2DPS);
                if(!is_numeric($Notaparcial1))  $Notaparcial1=0;
                if(!is_numeric($Notaparcial2))  $Notaparcial2=0;
                $Notaparcial1parcial2=$this->promedio(array($Notaparcial1, $Notaparcial2));
                if(!is_numeric($Notaparcial1parcial2))  $Notaparcial1parcial2=0;
                if(!is_numeric($NotaDPS))  $NotaDPS=0;
                if ($this->nivelPrimariaSecundaria=='primaria')     $NotaDPS=0;
                $NotaTrimestre2=$Notaparcial1parcial2 + $NotaDPS;
            }
             $fila++;
             $contUD=0;
             $contAE=0;
             $contDPS=0;
            echo '<tr>';
            for ($columna=1; $columna<=$numColumnas; $columna++){
                $nombreColumna="C".$columna;
                //$nombreColumna=$row['CodAlumno'].'-'.$nombreColumna;
                $nombreCelda=$row['CodAlumno'].'-'.$nombreColumna.'-'.$fila;

                echo '<td>';
                // Definir las formulas de las columnas
                $valorCelda='';
                 switch ($this->extraerValorDeArray($funciones,$nombreColumna)){
                    case 'contador':
                        $valorCelda=$fila;
                        break;
                    case 'nombreEstudiante':
                        $valorCelda='<div style="text-align:left">&nbsp;'.$row['estudiante'].'&nbsp;</div>';
                        echo '<input type="hidden" id="CodAlumno'.$fila.'" name="CodAlumno'.$fila.'" value="'.$row['CodAlumno'].'" />';
                        break;
                    case 'ud':
                        $contUD++;
                        if ($contUD<=8) $valorCelda=$row['ud'.$IdTrimestre.'0'.$contUD];
                        break;
                    case 'ae':
                        $contAE++;
                        if ($contAE<=9) $valorCelda=$row['ae'.$IdTrimestre.'0'.$contAE];
                        if ($contAE==10) $valorCelda=$row['ae'.$IdTrimestre.$contAE];
                        break;
                    case 'dps':
                        $contDPS++;
                        if ($contDPS<=3) $valorCelda=$row['dps'.$IdTrimestre.'0'.$contDPS];
                        break;
                    case 'rf':
                        $valorCelda=$row['rf'];
                        break;
                    case 'PromedioPrimerParcial':                        
                        $valorCelda=$this->promedio($ValoresSaberHacer);
                        break;
                    case 'PromedioPrimerParcial2':
                        $valorCelda=$this->promedio($ValoresSaberHacerParcial1);
                        break;
                    case 'PromedioPrimerParcial3':
                        $valorCelda=$NotaTrimestre1;
                        break;
                    case 'PromedioSegundoParcial':
                        $valorCelda=$this->promedio($ValoresSaberHacer);
                        break;
                    case 'PromedioSegundoParcial3':
                        $valorCelda=$NotaTrimestre2;
                        break; 
                    case 'PromedioPrimerMasSegundoParcial':                                                
                        $promedioParcial1=$this->promedio($ValoresSaberHacerParcial1);
                        $promedioParcial2=$this->promedio($ValoresSaberHacer);
                        $valoresDeParciales=array();
                        if (is_numeric($promedioParcial1))  $valoresDeParciales[]=$promedioParcial1;
                        if (is_numeric($promedioParcial2))  $valoresDeParciales[]=$promedioParcial2;
                        $valorCelda=$this->promedio($valoresDeParciales);
                        if (is_numeric($valorCelda))  $PromedioPrimerMasSegundoParcial=$valorCelda;
                        else $PromedioPrimerMasSegundoParcial=0;
                        break;
                    case 'PromedioDPS':                        
                        $valorCelda=$this->promedio($valoresDPS);
                        if (is_numeric($valorCelda))  $PromedioDPS=$valorCelda;
                        else $PromedioDPS=0;
                        break;
                    case 'PromedioTercerParcial':
                        $valorCelda=$this->promedio($ValoresSaberHacer);
                        break;
                    case 'PromedioTrimestral':
                        if ($this->nivelPrimariaSecundaria=='primaria') $valorCelda=$PromedioPrimerMasSegundoParcial;
                        else    $valorCelda=$PromedioPrimerMasSegundoParcial + $PromedioDPS;
                        
                        $NotaTrimestre3=$valorCelda;
                        break;
                    case 'PromedioTrimestres':
                        $valorCelda=$this->promedio(array($NotaTrimestre1,$NotaTrimestre2,$NotaTrimestre3));
                        $PromedioTrimestres=$valorCelda;
                        break;
                    case 'NotaFinal':
                        $valorCelda=$this->promedio(array($PromedioTrimestres,$row['rf']));
                        break;
                    default:
                    break;
                }
               // $valorCelda=$this->valorFuncion($this->extraerValorDeArray($funciones,$nombreColumna));
                //eval("\$valorCelda = \"$valorCelda\";");
                if (is_numeric($valorCelda) && $valorCelda==0)  $valorCelda='';

                $this->tipoCelda($this->extraerValorDeArray($tiposDeCelda,$nombreColumna), $nombreCelda,$valorCelda);
                echo '</td>';
            }
            echo '</tr>';
        }
        return($fila);
        //echo '</table>';
    }
    
    //calcula el promedio de un conjunto de datos enviados en un array(1,2,3,56,78..)
    function promedio($ArrayValores)
    {   $contador=0;
        $suma=0;
        
        foreach($ArrayValores as $valor){
            if ($valor != 0 && is_numeric($valor)){
                $suma=$suma + $valor;
                $contador++;
            }
        }

        if ($contador==0) return ('&nbsp;');
        else{
            return (round($suma/$contador,0, PHP_ROUND_HALF_UP));
        }       
    }
   
    function extraerValorDeArray($Array,$columnaAfectada){
        foreach($Array as $idColumna => $valorFuncion){
            if ($idColumna==$columnaAfectada)
                return ($valorFuncion);
        }
    }
    
    function tipoCelda($tipo,$nombreCelda,$valorCelda){
        switch ($tipo){
            case 'text':
                echo $valorCelda;
                break;
            case 'inputDisabled':
                //echo '<input type="text" name="'.$nombreCelda.'" id="'.$nombreCelda.'" value="'.$valorCelda.'" size="1" disabled />';
                if($valorCelda==0 || $valorCelda=='') $valorCelda='&nbsp';
                echo '<div id="'.$nombreCelda.'" style="font-weight: bold;">'.$valorCelda.'</div>';
                break;

            case 'inputDPS':
                //en primaria desabilita DPS                
                    echo '<input type="text" name="'.$nombreCelda.'" id="'.$nombreCelda.'" value="'.$valorCelda.'" size="1" maxlength="2" onblur="validarSiNumero(this);" readonly />';
                break;
            case 'inputDisableAeDPS':
                if ($this->nivelPrimariaSecundaria=='primaria')
                    echo '<input type="text" name="'.$nombreCelda.'" id="'.$nombreCelda.'" value="'.$valorCelda.'" size="1" maxlength="2" onblur="validarSiNumero(this);" disabled />';
                else
                    echo '<input type="text" name="'.$nombreCelda.'" id="'.$nombreCelda.'" value="'.$valorCelda.'" size="1" maxlength="2" onblur="validarSiNumero(this);" />';
                break;
            default:
                
                echo '<input type="text" name="'.$nombreCelda.'" id="'.$nombreCelda.'" value="'.$valorCelda.'" size="1" maxlength="2" onblur="validarSiNumero(this);" />';
                break;
        }
    }

    function registroNotas ($valor,$MateriaEstudiantes,$trimestre,$IdTrimestre,$nivel,$CodMateria){
        $this->nivelPrimariaSecundaria=$nivel;
        $funciones=array();
        $tiposCeldas=array();
        switch ($valor){
            case 'parcial1':
                $this->encabezado1($trimestre,$IdTrimestre,$CodMateria);
                //Definir funciones que se aplicaran a las columnas
                $funciones['C1']='contador';
                $funciones['C2']='nombreEstudiante';
                $funciones['C3']='ud';
                $funciones['C4']='ud';
                $funciones['C5']='ud';
                $funciones['C6']='ud';
                $funciones['C7']='ud';
                $funciones['C8']='ud';
                $funciones['C9']='ud';
                $funciones['C10']='ud';
                $funciones['C11']='ae';
                $funciones['C12']='ae';
                $funciones['C13']='ae';
                $funciones['C14']='ae';
                $funciones['C15']='ae';
                $funciones['C16']='ae';
                $funciones['C17']='ae';
                $funciones['C18']='ae';
                $funciones['C19']='ae';
                $funciones['C20']='ae';
                //$funciones['C21']='PromedioPrimerParcial';
				
				if( $nivel=='primaria' ) {
					$funciones['C21']='PromedioDPS';
				}
				else {
					$funciones['C21']='ae';
				}
				$funciones['C22']='PromedioPrimerParcial';
				
                //Definir los tipos de celda que se mostrara
                $tiposCeldas['C1']='text';
                $tiposCeldas['C2']='text';
                $tiposCeldas['C21']='inputDisabled';                
				
				//$tiposCeldas['C22']='inputDisabled';                
                //Define el numero de columnas de la tabla
                $columnas=22;
                break;

            case 'parcial2':
                $this->encabezado2($trimestre,$IdTrimestre,$CodMateria);
                //Definir funciones que se aplicaran a las columnas
                $funciones['C1']='contador';
                $funciones['C2']='nombreEstudiante';
                $funciones['C3']='PromedioPrimerParcial2';
                $funciones['C4']='ud';
                $funciones['C5']='ud';
                $funciones['C6']='ud';
                $funciones['C7']='ud';
                $funciones['C8']='ud';
                $funciones['C9']='ud';
                $funciones['C10']='ud';
                $funciones['C11']='ud';
                $funciones['C12']='ae';
                $funciones['C13']='ae';
                $funciones['C14']='ae';
                $funciones['C15']='ae';
                $funciones['C16']='ae';
                $funciones['C17']='ae';
                $funciones['C18']='ae';
                $funciones['C19']='ae';
                $funciones['C20']='ae';
                //$funciones['C21']='ae';

				if( $nivel=='primaria' ) {
					$funciones['C21']='PromedioDPS';
				}
				else {
					$funciones['C21']='ae';
				}
				$funciones['C22']='PromedioSegundoParcial';

                //$funciones['C22']='PromedioSegundoParcial';
                $funciones['C23']='PromedioPrimerMasSegundoParcial';
                $funciones['C24']='dps';
                $funciones['C25']='dps';
                $funciones['C26']='dps';
                $funciones['C27']='PromedioDPS';    
                $funciones['C28']='PromedioTrimestral';
                //Definir los tipos de celda que se mostrara
                $tiposCeldas['C1']='text';
                $tiposCeldas['C2']='text';
                $tiposCeldas['C3']='inputDisabled';
                $tiposCeldas['C21']='inputDisableAeDPS';
                $tiposCeldas['C22']='inputDisabled';
                $tiposCeldas['C23']='inputDisabled';
                $tiposCeldas['C24']='inputDPS';
                $tiposCeldas['C25']='inputDPS';
                $tiposCeldas['C26']='inputDPS';
                $tiposCeldas['C27']='inputDisabled';
                $tiposCeldas['C28']='inputDisabled';
                $columnas=28;
                break;

            case 'parcial3':
                $this->encabezado3($trimestre,$IdTrimestre,$CodMateria);

                //Definir funciones que se aplicaran a las columnas
                $funciones['C1']='contador';
                $funciones['C2']='nombreEstudiante';
                $funciones['C3']='PromedioPrimerParcial2';
                $funciones['C4']='ud';
                $funciones['C5']='ud';
                $funciones['C6']='ud';
                $funciones['C7']='ud';
                $funciones['C8']='ud';
                $funciones['C9']='ud';
                $funciones['C10']='ud';
                $funciones['C11']='ud';
                $funciones['C12']='ae';
                $funciones['C13']='ae';
                $funciones['C14']='ae';
                $funciones['C15']='ae';
                $funciones['C16']='ae';
                $funciones['C17']='ae';
                $funciones['C18']='ae';
                $funciones['C19']='ae';
                $funciones['C20']='ae';
				//$funciones['C21']='ae';
				if( $nivel=='primaria' ) {
					$funciones['C21']='PromedioDPS';
				}
				else {
					$funciones['C21']='ae';
				}
				$funciones['C22']='PromedioTercerParcial';
				//$funciones['C22']='PromedioDPS';
                $funciones['C23']='PromedioPrimerMasSegundoParcial';
                $funciones['C24']='dps';
                $funciones['C25']='dps';
                $funciones['C26']='dps';
                $funciones['C27']='PromedioDPS';
                $funciones['C28']='PromedioTrimestral';

                $funciones['C29']='PromedioSegundoParcial3';
                $funciones['C30']='PromedioPrimerParcial3';
                $funciones['C31']='PromedioTrimestres';
                $funciones['C32']='rf';
                $funciones['C33']='NotaFinal';
                //Definir los tipos de celda que se mostrara
                //$tiposCeldas['C1']='text';
				$tiposCeldas['C1']='inputDisabled';
                $tiposCeldas['C2']='text';
                $tiposCeldas['C3']='inputDisabled';
                $tiposCeldas['C21']='inputDisableAeDPS';
                $tiposCeldas['C22']='inputDisabled';
                $tiposCeldas['C23']='inputDisabled';
                $tiposCeldas['C24']='inputDPS';
                $tiposCeldas['C25']='inputDPS';
                $tiposCeldas['C26']='inputDPS';
                $tiposCeldas['C27']='inputDisabled';
                $tiposCeldas['C28']='inputDisabled';
                $tiposCeldas['C29']='inputDisabled';
                $tiposCeldas['C30']='inputDisabled';
                $tiposCeldas['C31']='inputDisabled';
                $tiposCeldas['C33']='inputDisabled';
                $columnas=33;
                break;
            default:
                echo 'valor no encontrado';
                break;
        }
        $funciones['B']='nombreEstudiante';
        $numfilas=$this->tabla($columnas,$funciones,$tiposCeldas,$MateriaEstudiantes,$IdTrimestre);
        return($numfilas);
    }

    function encabezado1 ($trimestre,$IdTrimestre,$CodMateria){
        echo '
        <tr>
        <th rowspan="4">Nro</th>
        <th rowspan="4">NOMINA</th>
        <th colspan="18"><strong>PRIMER PARCIAL '.$trimestre.'</strong></th>
        <th rowspan="4"> Prom. <br /> 1er <br />Parcial   </th>
        </tr>
        <tr>
        <th colspan="8">SABER</th>
        <th colspan="10">HACER</th>
        </tr>
        <tr>
        <th colspan="8"><a href="#" onclick="abrirRotulo(\'index.php?ctr=Index&acc=Ctr_Rotulo&CodMateria='.$CodMateria.'&IdTrimestre='.$IdTrimestre.'\',0,0,0,0,0,0,0,380,420,100,100,0);">UNIDADES DIDACTICAS</a></th>
        <th colspan="10"><a href="#" onclick="abrirRotulo(\'index.php?ctr=Index&acc=Ctr_Rotulo&CodMateria='.$CodMateria.'&IdTrimestre='.$IdTrimestre.'\',0,0,0,0,0,0,0,380,420,100,100,0);">ACTIVIDADES EVALUATIVAS</a></th>
        </tr>
        <tr>
        <th>1</th>
        <th>2</th>
        <th>3</th>
        <th>4</th>
        <th>5</th>
        <th>6</th>
        <th>7</th>
        <th>8</th>
        <th>1</th>
        <th>2</th>
        <th>3</th>
        <th>4</th>
        <th>5</th>
        <th>6</th>
        <th>7</th>
        <th>8</th>
        <th>9</th>
        <th>10</th>
        </tr>';
    }

    function encabezado2 ($trimestre,$IdTrimestre,$CodMateria){
         $valor='10';
        if ($this->nivelPrimariaSecundaria=='primaria') $valor='DPS';
        echo '
        <tr>
            <th rowspan="4">Nro</th>
            <th rowspan="4">NOMINA</th>
            <th rowspan="4">Prom <br /> 1er <br />Par </th>
            <th colspan="18"><strong>SEGUNDO PARCIAL '.$trimestre.'</strong></th>
            <th rowspan="4"> Prom <br /> 2do <br />Par   </th>
            <th rowspan="4"> Prom <br /><br /> 1er<br />+<br />2do <br /><br />Par   </th>
            <th colspan="4"> D.P.S. </th>
            <th colspan="4" rowspan="4"> PROM. <br /> <br />T<br />R<br />I<br />M<br />E<br />S<br />T<br />R<br />A<br />L </th>
        </tr>
        <tr>
            <th colspan="8">SABER</th>
            <th colspan="10">HACER</th>
            <th  rowspan="3" style="font-size:10px">P<br />P<br />F<br />F</th>
            <th  rowspan="3" style="font-size:10px">E<br />S<br />T<br />U<br />D<br />I<br />A<br />N<br />T<br />E</th>
            <th  rowspan="3" style="font-size:10px">P<br />R<br />O<br />F<br />E<br />S<br />O<br />R</th>
            <th  rowspan="3">Prom <br /> DPS</th>
        </tr>
        <tr>        
            <th colspan="8"><a href="#" onclick="abrirRotulo(\'index.php?ctr=Index&acc=Ctr_Rotulo&CodMateria='.$CodMateria.'&IdTrimestre='.$IdTrimestre.'\',0,0,0,0,0,0,0,380,420,100,100,0);">UNIDADES DIDACTICAS</a></th>
            <th colspan="10"><a href="#" onclick="abrirRotulo(\'index.php?ctr=Index&acc=Ctr_Rotulo&CodMateria='.$CodMateria.'&IdTrimestre='.$IdTrimestre.'\',0,0,0,0,0,0,0,380,420,100,100,0);">ACTIVIDADES EVALUATIVAS</a></th>
        </tr>
        <tr>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7</th>
            <th>8</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7</th>
            <th>8</th>
            <th>9</th>
            <th>'.$valor.'</th>
        </tr>';
    }
    
    function encabezado3 ($trimestre,$IdTrimestre,$CodMateria){
        $valor='10';
        if ($this->nivelPrimariaSecundaria=='primaria') $valor='DPS';
        echo '
        <tr>
            <th rowspan="4">Nro</th>
            <th rowspan="4">NOMINA</th>
            <th rowspan="4">Prom <br /> 1er <br />Par </th>
            <th colspan="18"><strong>SEGUNDO PARCIAL '.$trimestre.'</strong></th>
            <th rowspan="4"> Prom<br /> 2do <br />Par   </th>
            <th rowspan="4"> Prom<br /><br /> 1er<br />+<br />2do <br /><br />Par   </th>
            <th colspan="4"> D.P.S. </th>
            <th rowspan="4"><br /> 3er <span style="font-size:10px"> <br /><br />T<br />R<br />I<br />M<br />E<br />S<br />T<br />R<br />E </span> </th>
            <th colspan="2">RESUMEN</th>
            <th rowspan="4">P<br />R<br />O<br />M<br />E<br />D<br />I<br />O &nbsp;</th>
            <th rowspan="4"> R<br />E<br />F<br />O<br />R<br />Z<br />A<br />M<br />I<br />E<br />N<br />T<br />O </th>
            <th rowspan="4"> PROM.<br /><br /> P<br />R<br />O<br />M<br />O<br />C. </th>
        </tr>
        <tr>
            <th colspan="8">SABER</th>
            <th colspan="10">HACER</th>
            <th  rowspan="3" style="font-size:10px">P<br />P<br />F<br />F</th>
            <th  rowspan="3" style="font-size:10px">E<br />S<br />T<br />U<br />D<br />I<br />A<br />N<br />T<br />E</th>
            <th  rowspan="3" style="font-size:10px">P<br />R<br />O<br />F<br />E<br />S<br />O<br />R</th>
            <th  rowspan="3">Prom <br /> DPS</th>
            <th rowspan="3"><br />2do<span style="font-size:10px"> <br /><br />T<br />R<br />I<br />M<br />E<br />S<br />T<br />R<br />E </span> </th>
            <th rowspan="3"><br />1er <span style="font-size:10px"> <br /><br />T<br />R<br />I<br />M<br />E<br />S<br />T<br />R<br />E </span></th>
        </tr>
        <tr>
            <th colspan="8"><a href="#" onclick="abrirRotulo(\'index.php?ctr=Index&acc=Ctr_Rotulo&CodMateria='.$CodMateria.'&IdTrimestre='.$IdTrimestre.'\',0,0,0,0,0,0,0,380,420,100,100,0);">UNIDADES DIDACTICAS</a></th>
            <th colspan="10"><a href="#" onclick="abrirRotulo(\'index.php?ctr=Index&acc=Ctr_Rotulo&CodMateria='.$CodMateria.'&IdTrimestre='.$IdTrimestre.'\',0,0,0,0,0,0,0,380,420,100,100,0);">ACTIVIDADES EVALUATIVAS</a></th>
        </tr>
        <tr>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7</th>
            <th>8</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7</th>
            <th>8</th>
            <th>9</th>
            <th>'.$valor.'</th>
        </tr>';

    }
    //convierte numeros a letras del alfabeto A,B,C...Z,AA,BB,CC,...ZZ,AAA,BBB,CCC,...ZZZ,....
    function nombreColumna ($columna){
        $cociente=0;

        if ($columna>26){
            $cociente = floor($columna / 26);
            $columna = $columna%26;
            if ($columna==0) $columna=26;
        }

        foreach(range('A', 'Z') as $numero=>$letra) {
            if ($columna == ($numero + 1))
            {   $valor='';
                for($i=0; $i<=$cociente;$i++){
                    $valor.=$letra;
                }
            }
         }
        return ($valor);
    }
}
?>

<?php
/*
 * 
$imprimir=new gms_TablaInput();

$imprimir->registroNotas('Secundaria1');
echo '<br /><br />';
$imprimir->registroNotas('Secundaria2');
echo '<br /><br />';
$imprimir->registroNotas('Secundaria3');
 *
 */
/*
$columna=78;
$cociente=0;

        if ($columna>26){
        $cociente = floor($columna / 26);
        $columna = $columna%26;
            if ($columna==0) $columna=26;
        }

        foreach(range('A', 'Z') as $numero=>$letra) {
            if ($columna == ($numero + 1))
            {   $valor='';
                for($i=0; $i<=$cociente;$i++){
                    $valor.=$letra;
                }
            }
         }
echo $valor;
 * */
 
?>