<?php
global $Linea1, $Linea2, $Linea3, $Titulo;

$Linea1 =  $this->modelo_valores->GetTexto('LINEA1');		 
$Linea2 =  $this->modelo_valores->GetTexto('LINEA2');
$Linea3 =  $this->modelo_valores->GetTexto('LINEA3');
$Titulo = "Reporte de OT's por fecha";

$this->fpdf->SetAutoPageBreak(TRUE, 20);
$this->fpdf->Open();
$this->fpdf->SetMargins(25, 10, 20);
$this->fpdf->SetTextColor(0,0,0);
$this->fpdf->AliasNbPages();
$this->fpdf->AddPage('P', 'Letter');
$this->fpdf->setFont('Arial', '', 12);

$Cell_desde=($Desde=='') ? '<Fecha inicial>' : $this->funciones->FechaLiteral($Desde,4) ;
$this->fpdf->Cell(20, 5, 'Desde:', 0, 0, 'L');  $this->fpdf->Cell(0,5, $Cell_desde, 0, 1, 'L');
$Cell_hasta=($Hasta=='') ? '<Fecha final>' : $this->funciones->FechaLiteral($Hasta,4) ;
$this->fpdf->Cell(20, 5, 'Hasta:', 0, 0, 'L');  $this->fpdf->Cell(40,5, $Cell_hasta, 0, 1, 'L');
$Cell_estado=($Estado=='') ? '<Todos>' : $this->modelo_estado->GetNombre($Estado);
$this->fpdf->Cell(20, 5, 'Estado:', 0, 0, 'L');  $this->fpdf->Cell(40,5, $Cell_estado, 0, 1, 'L');
$FechaActual=$this->funciones->FechaLiteral($this->funciones->FechaParaMySQL(date('d/m/Y')), 4);
$this->fpdf->Cell(20, 5, 'Fecha:', 0, 0, 'L');  $this->fpdf->Cell(25,5, $FechaActual, 0, 1, 'L');

//Espacio de separacion entre cabecera y tabla
$this->fpdf->Cell(40, 5, ' ', 0, 1, 'R');

//cabezera de fila
$this->fpdf->setFont('times', 'B', 10);

$this->fpdf->SetFillColor(220, 220, 220);
$this->fpdf->Cell(10, 5, ' No.', 1, 0, 'C',1);
$this->fpdf->Cell(17, 5, ' Número', 1, 0, 'C',1);
$this->fpdf->Cell(20, 5, ' Fecha', 1, 0, 'C',1);
$this->fpdf->Cell(35, 5, ' Nombre artículo', 1, 0, 'C',1);
$this->fpdf->Cell(35, 5, ' Nombre marca', 1, 0, 'C',1);
$this->fpdf->Cell(35, 5, ' Estado', 1, 0, 'C',1);
$this->fpdf->Cell(22, 5, ' Precio', 1, 1, 'C',1);

//cuerpo del reporte
$this->fpdf->setFont('times', '', 10);
$cont=0;
foreach ($Tabla->result() as $fila){
	$cont++;
	$this->fpdf->Cell(10, 5, $cont, 1, 0, 'R');
	$this->fpdf->Cell(17, 5, utf8_decode($fila->Numero) , 1, 0, 'R');	
	$this->fpdf->Cell(20, 5, $this->funciones->FechaLiteral($fila->Fecha), 1, 0, 'R');	
	$this->fpdf->Cell(35, 5, ($fila->NombreArticulo), 1, 0, 'L');
	$this->fpdf->Cell(35, 5, ($fila->NombreMarca), 1, 0, 'L');
	$this->fpdf->Cell(35, 5, ($fila->NombreEstado), 1, 0, 'L');
	$this->fpdf->Cell(22, 5, ($fila->Precio), 1, 1, 'R');	
	
	if ($IncluirObs==1)
		$this->fpdf->Cell(170, 5, utf8_decode('Observación: '.($fila->Obs)), 1, 1, 'L');	
}

$aux = "Reporte.pdf";
$this->fpdf->Output($aux, 'D');